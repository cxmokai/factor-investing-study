# 数学复习计划

> **目标：** 复习因子投资所需的最小数学知识，不多不少
> **时间：** 10 天，每天 2 小时

---

## 为什么需要这些数学

因子投资的核心操作是：**用回归模型检验某个因子是否能解释股票收益，再用优化方法构建投资组合。** 这条链路涉及的数学分支如下：

| 数学分支 | 因子投资中的用途 | 重要程度 |
|---------|----------------|:---:|
| 线性代数 | 协方差矩阵、因子模型的矩阵表达、PCA | 必须 |
| 概率与统计 | 收益率分布、风险度量、假设检验 | 必须 |
| 回归分析 | 因子模型估计、Alpha/Beta 计算 | 核心 |
| 时间序列 | 收益率平稳性、自相关、避免伪回归 | 必须 |
| 优化 | 投资组合构建（均值-方差优化） | 必须 |

**一句话总结：** 因子投资 = 回归（检验因子） + 优化（构建组合），其余数学为这两者服务。

---

## 视频资源

| 资源 | 用途 | 说明 |
|------|------|------|
| 3Blue1Brown "Essence of Linear Algebra" | 模块一：线性代数直觉复习 | YouTube，16集，共约3小时，最好的线性代数直觉教程 |
| StatQuest (Josh Starmer) | 模块二-五：统计、回归、PCA、时间序列 | YouTube，每集5-15分钟，用极简方式讲统计概念 |
| Khan Academy "Statistics and Probability" | 模块二：概率论基础补充 | khanacademy.org，适合从头梳理概率概念 |

> 本计划以视频为主、Jupyter 验证为辅。对于编程能力强但数学生疏的人，视频比教科书更高效——看完 3Blue1Brown 的线性代数直觉，比重读课本一章收获更大。

---

## 模块一：线性代数要点（Day 12-13）

**目标：** 能读懂协方差矩阵，理解因子模型 r = Xb + e 的矩阵含义

### Day 12：向量、矩阵、基本运算

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 向量（几何直觉）、线性组合、线性变换、矩阵乘法 | 3Blue1Brown Ep 1-4 |
| 1h | 行列式、逆矩阵、转置、矩阵的秩 | 3Blue1Brown Ep 5-6 + 补充讲义 |

**和因子投资的联系：**
- 投资组合 = 权重向量 w 乘以收益率向量 r → 组合收益 = w'r
- 因子模型的矩阵形式：r = Xb + e（r 是收益率向量，X 是因子暴露矩阵，b 是因子收益向量）
- 协方差矩阵的逆矩阵在组合优化中直接使用

### Day 13：特征值与正定矩阵

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 特征值与特征向量的几何意义、特征分解 | 3Blue1Brown Ep 14 + 补充讲义 |
| 1h | 对称矩阵、正半定矩阵、协方差矩阵的矩阵视角 | 补充讲义 |

**和因子投资的联系：**
- 协方差矩阵是对称半正定矩阵——这保证组合方差永远非负
- 特征分解是 PCA 的数学基础——PCA 用于从收益率数据中提取统计因子
- 特征值 = 该方向上的方差大小，特征向量 = 方差最大的方向

**学完能回答：**
- 矩阵乘法 AB 的第 (i,j) 个元素代表什么？
- 为什么协方差矩阵一定是半正定的？
- 特征值分解和 PCA 有什么关系？

---

## 模块二：概率与统计（Day 14-16）

**目标：** 理解收益率分布的性质，掌握假设检验——判断因子是否"真的有效"

### Day 14：随机变量、期望、方差、分布

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 随机变量、期望（均值）、方差、标准差 | StatQuest: "Statistics Fundamentals" 系列 |
| 1h | 正态分布（68-95-99.7 规则）、对数正态分布、肥尾现象 | StatQuest + Khan Academy |

**和因子投资的联系：**
- 股票收益率 ≈ 正态分布，但有"肥尾"（极端事件比正态分布预测的多）
- 对数收益率 ln(P_t/P_{t-1}) 比简单收益率更接近正态，且可以跨时间相加——这就是量化常用对数收益率的原因
- 标准差 = 波动率——最基本的风险度量

### Day 15：协方差、相关性、大数定律、中心极限定理

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 协方差、相关系数、联合分布 | StatQuest: "Covariance and Correlation" |
| 1h | 大数定律、中心极限定理（CLT）、抽样分布 | StatQuest + Khan Academy |

**和因子投资的联系：**
- 分散投资降低风险的数学本质：组合方差 = 各资产方差 + 协方差项；当资产间相关性低，协方差项小，组合风险下降
- CLT 解释了为什么能用 t 检验判断因子是否有效——样本均值的分布趋近正态
- 回测年数太短 = 样本量不够 → CLT 不起作用 → 结论不可靠

### Day 16：假设检验与多重检验

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 零假设、备择假设、p 值、t 检验、显著性水平、第一类/第二类错误 | StatQuest: "Hypothesis Testing and p-values" |
| 1h | 多重检验问题：为什么大量检验会产生假发现？Bonferroni 校正、FDR | StatQuest: "FDR and the Benjamini-Hochberg Method" |

**和因子投资的联系：**
- "这个因子的 Alpha 显著吗？" = 对 Alpha 做 t 检验
- 多重检验是因子投资最大的统计陷阱：如果你测试了 100 个因子，即使全部无效，也会有约 5 个在 p < 0.05 水平上"显著"
- Harvey, Liu & Zhu (2016) 指出：学术界发表的大量"因子"可能是多重检验造成的假发现
- 这就是为什么因子投资不能"数据挖掘"——必须有经济学逻辑支撑

**学完能回答：**
- p = 0.03 意味着什么？能说"因子有效的概率是 97%"吗？
- 如果同时检验 100 个因子，怎么控制误发现率？
- 为什么回测年数太短的结果不可靠？和 CLT 有什么关系？

---

## 模块三：回归分析（Day 17-18）⭐ 核心

**目标：** 掌握 OLS 回归——因子投资的第一工具

> 因子投资的几乎所有实证研究都建立在回归分析之上。Fama-French 三因子模型就是一个多元回归：
> R_i - R_f = alpha + b1 * MKT + b2 * SMB + b3 * HML + e
> 读懂这个公式、估计参数、解读结果，就是这两天的目标。

### Day 17：OLS 回归（简单 + 多元）

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 简单线性回归：最小二乘法直觉、公式 b = (X'X)^{-1}X'y、残差、拟合优度 R^2 | StatQuest: "Linear Regression" 系列 |
| 1h | 多元回归：多个自变量、偏回归系数、调整 R^2、F 检验、系数的 t 检验 | StatQuest: "Multiple Regression" |

**和因子投资的联系：**
- CAPM：R_i - R_f = alpha + beta * (R_m - R_f) + e → 简单回归，斜率 = Beta
- FF3：加入 SMB（规模因子）和 HML（价值因子）→ 多元回归
- alpha 的 t 值 > 2（大约对应 p < 0.05）→ "该资产存在超额收益"
- R^2 = 模型解释了多少收益率变动 → FF3 的 R^2 通常约 0.9

### Day 18：回归诊断——为什么金融数据需要特殊处理

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | OLS 假设、异方差（heteroscedasticity）、自相关（autocorrelation）、Newey-West 标准误 | StatQuest + 补充讲义 |
| 1h | 多重共线性（VIF）、遗漏变量偏误、虚假回归 | StatQuest + 补充讲义 |

**和因子投资的联系：**
- 金融收益率数据几乎必然违反 OLS 的"同方差"和"无自相关"假设
- 直接使用普通标准误会低估不确定性 → 因子看起来"显著"但其实不是
- Newey-West 标准误 = 因子研究的标配，几乎所有论文都用
- 多重共线性：如果两个因子高度相关（如 SMB 和某个流动性因子），回归系数不稳定

**学完能回答：**
- OLS 回归的公式 b = (X'X)^{-1}X'y 中，每一步在做什么？
- 为什么金融数据不能直接用普通 OLS 标准误？
- Newey-West 标准误解决了什么问题？
- R^2 = 0.9 在因子模型中意味着什么？

---

## 模块四：时间序列基础（Day 19）

**目标：** 理解平稳性和自相关——避免用价格做回归的致命错误

### Day 19：平稳性、自相关、白噪声

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 时间序列的概念、平稳性（强/弱平稳）、差分、ADF 检验 | StatQuest + Khan Academy |
| 1h | 自相关函数（ACF）、偏自相关函数（PACF）、白噪声、AR(1) 模型直觉（y_t = φy_{t-1} + ε_t） | StatQuest + 补充讲义 |

**和因子投资的联系：**
- 股票价格是非平稳的（有趋势），收益率 = 价格的一阶差分，是（近似）平稳的
- 用价格做回归 → 伪回归（spurious regression）→ R^2 虚高、结论全错
- 这就是为什么因子模型用的是收益率（return）而不是价格（price）
- 动量因子和均值回复本质上依赖于收益率的自相关性质

**学完能回答：**
- 为什么不能直接拿股票价格做回归？
- 如何判断一个时间序列是否平稳？
- ACF 图上第 k 期的柱子代表什么？

---

## 模块五：优化与降维（Day 20-21）

**目标：** 理解组合优化的数学框架和 PCA 的直觉

### Day 20：约束优化与均值-方差优化

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | 无约束/有约束优化、凸函数直觉、拉格朗日乘数法 | Khan Academy: "Lagrange Multipliers" |
| 1h | 均值-方差优化的数学推导：目标函数、约束条件、有效前沿的形成 | 补充讲义 |

**和因子投资的联系：**
- Markowitz 组合优化 = 在给定目标收益下最小化组合方差
- 这是一个典型的二次规划问题（目标函数是二次的，约束是线性的）
- 实际中不需要手算，Python 的 scipy.optimize 或 cvxpy 可以直接求解
- 但必须理解：优化器在做什么，输入是什么（期望收益、协方差矩阵），输出是什么（最优权重）

### Day 21：PCA 直觉与整合复习

| 时间 | 内容 | 资料 |
|------|------|------|
| 1h | PCA 的直觉：降维、方差最大化方向、与特征分解的关系、解释方差比 | StatQuest: "PCA" 系列（3 集） |
| 1h | 整合复习：从数据到因子模型到组合优化的完整数学链路 | 补充讲义 |

**和因子投资的联系：**
- 统计因子模型（如 Connor & Korajczyk）用 PCA 从大量股票的收益率中"提取"潜在因子
- 第一个主成分 ≈ 市场因子，后续主成分 ≈ 行业因子、规模因子等
- PCA 也用于协方差矩阵的降噪——去掉小特征值对应的噪声维度

**学完能回答：**
- 拉格朗日乘数法在解什么问题？
- 均值-方差优化的输入和输出各是什么？
- PCA 的第一个主成分为什么通常是市场因子？

---

## 不需要学的

以下数学内容对因子投资**不是必需的**，暂时跳过：

| 内容 | 跳过原因 |
|------|---------|
| 微积分（求导、积分） | 因子投资主要用离散计算，优化用库解决 |
| 测度论 / 实分析 | 纯数学，量化金融博士才需要 |
| 随机过程（布朗运动、伊藤引理） | 衍生品定价需要，因子投资不需要 |
| 贝叶斯统计 | 高级因子模型会用（如 Black-Litterman），基础阶段不需要 |
| ARIMA / GARCH 建模 | 时间序列预测模型，因子投资侧重截面分析而非时序预测 |
| 高级优化（整数规划、非凸优化） | 基础组合优化是凸的，高级约束后续再学 |
| 信息论（熵、互信息） | 机器学习因子模型可能用到，基础阶段不需要 |

---

## 数学和因子投资的完整链路

```
数据获取
  ↓ 价格序列
差分（时间序列 Day 19）
  ↓ 收益率序列（平稳）
描述统计（概率统计 Day 14-15）
  ↓ 均值、方差、协方差矩阵
因子检验（回归 Day 17-18）
  ↓ alpha, beta, t值, p值
假设检验（统计 Day 16）
  ↓ "这个因子显著吗？"
多重检验校正（统计 Day 16）
  ↓ "在测了这么多因子之后，它还显著吗？"
组合优化（优化 Day 20）
  ↓ 最优权重
投资组合
```

---

## 与金融知识的对应关系

| 金融知识模块 | 需要的数学 | 数学对应天数 |
|------------|-----------|:----------:|
| 模块三：收益与风险度量（Day 5） | 均值、方差、标准差、正态分布 | Day 14 |
| 模块四：投资组合理论（Day 6-7） | 协方差矩阵、优化 | Day 12-13, 20 |
| 模块五：CAPM 与多因子模型（Day 8-10） | 回归分析、假设检验 | Day 16-18 |
| 模块六：行为金融（Day 11） | 无额外数学需求 | — |

> **建议学习顺序：** 按全局顺序先完成金融知识（Day 1-11），再进入数学复习（Day 12-21）。这样在复习数学时已经有金融直觉，概念更容易落地。

---

## 后续衔接

数学复习 10 天完成后，进入：
- **因子投资（Day 22-39）**：因子投资方法论，会用到回归、假设检验、多重检验等所有数学工具
- **编程实践（Day 40-69）**：用 Python 实现所有数学概念（另有独立计划）
- **论文阅读**：Fama & French (1993) 是一篇回归分析的应用，学完数学后可以逐行读懂
