# 数学讲义编写指南

> 本文档参照「金融知识讲义编写指南」的方法论，针对数学内容做适配。
> 用于复现 Day 1-10 的数学讲义。

---

## 一、编写流程

```
第1步：确定当天内容范围
  └→ 查看「数学复习计划.md」中该天的模块、知识点、对应视频资源

第2步：列出所有知识点
  └→ 从对应的视频/教材中提取核心概念
  └→ 只保留因子投资必需的，跳过纯数学证明

第3步：排列知识点顺序
  └→ 原则：直觉→形式化，二维→高维，特例→一般
  └→ 例：Day 1 先讲"向量是箭头"（直觉），再讲"矩阵乘法公式"（形式化）

第4步：为每个知识点编写内容（见下方"单个知识点的写法"）

第5步：编写自测题（概念题 + 计算题各半）

第6步：检查完整性
  └→ 读完讲义后，是否还需要看视频？如果需要，说明内容不够完整
  └→ 所有公式是否正确（单位、下标、维度）
  └→ 所有 Mermaid 图是否语法正确
  └→ 所有数值例子是否可以手算验证
```

---

## 二、文档结构模板

```markdown
# Day N：标题

> **总时长：** 2 小时
> **节奏：** 每 50 分钟休息 10 分钟
> **今日目标：** 一句话说清楚今天学完能算什么 / 能读懂什么
> **本文是完整讲义，包含所有知识点，不需要翻阅其他资料**

---

## 时间表

（精确到分钟的时间分配）

---

## 第一节：xxx（50 分钟）

### 一、第一个大主题
#### 1.1 小知识点
（内容）

### 第一节完成检查
- [ ] 检查项 1（能力型：能用自己的话解释 xxx）
- [ ] 检查项 2（计算型：能手算 xxx）

**休息 10 分钟。**

---

## 第二节：xxx（50 分钟）

### 二、第二个大主题
（内容）

### 第二节完成检查
- [ ] 检查项

---

## 收尾：自测（10 分钟）

（自测题 + 评分标准）

---

## 今天不需要记住的内容

（降低焦虑，明确边界——数学尤其需要）

---

## 明天预告

（1-3 句话，制造期待）
```

---

## 三、单个知识点的写法

每个知识点按以下顺序组织，**不是每一步都必须**，根据概念复杂度取舍：

### 1. 一句话定义（必须）

用加粗的一句话给出最简定义，抓住核心。数学概念应同时给出文字和公式。

> **协方差 = 两个变量一起偏离各自均值的平均程度。**
> Cov(X, Y) = E[(X - E[X])(Y - E[Y])]

### 2. 为什么要学这个（必须）

和因子投资的联系。这一步对数学概念尤其重要——"学数学"最容易让人失去动力，必须时刻说清"学这个是为了什么"。

> 协方差矩阵是投资组合理论的核心输入。Markowitz 优化、风险模型、因子模型全部建立在协方差矩阵之上。

### 3. 几何直觉 / 视觉直觉（复杂概念必须）

数学概念的类比不一定来自生活，更多来自**几何图形**和**视觉化**。

好的数学直觉：

| 概念 | 直觉 |
|------|------|
| 向量 | 从原点出发的箭头，有方向和长度 |
| 矩阵乘法 | 对空间的线性变换（旋转、拉伸、投影） |
| 特征值 | 变换后方向不变的特殊方向上的拉伸倍数 |
| 正定矩阵 | 从任何方向看都是"碗形"的曲面 |
| 协方差 | 散点图的椭圆倾斜方向 |
| PCA | 找到数据散布最广的方向 |

直觉的原则：
- 优先用几何/图形解释，而不是生活类比
- 先给 2D 的直觉，再推广到高维
- 3 句话以内说完核心直觉

### 4. 公式（涉及计算的概念必须）

公式的书写规范：

```
写法：使用 LaTeX 风格的行内标记
  - 行内公式用 `` 包裹，如 `Var(X) = E[X^2] - (E[X])^2`
  - 独立公式单独一行，前后空行

公式不是推导：
  - 只给最终结果和关键中间步骤
  - 跳过纯代数化简
  - 如果推导有助于理解，用"为什么是这个公式"的方式讲，而不是"请看以下推导"

公式必须配文字：
  - 每个符号第一次出现时解释含义
  - 公式后面紧跟一句"翻译成人话"的解释
```

示例：

> 两资产组合的方差：
>
> `sigma_p^2 = w1^2 * sigma1^2 + w2^2 * sigma2^2 + 2 * w1 * w2 * Cov(r1, r2)`
>
> 翻译成人话：组合风险 = 资产1的风险贡献 + 资产2的风险贡献 + 两者联动的风险贡献。如果两个资产不怎么联动（协方差小），第三项就小，组合风险就低于单个资产——这就是分散投资的数学本质。

### 5. 手算例子（涉及计算的概念必须）

用小规模的数字（2x2 矩阵、3 个数据点）让读者能在纸上验证。

> **手算：2 只股票的协方差**
>
> 股票 A 的月收益率：+3%, -1%, +2%
> 股票 B 的月收益率：+2%, +1%, -1%
>
> A 的均值 = (3-1+2)/3 = 1.33%
> B 的均值 = (2+1-1)/3 = 0.67%
>
> Cov = [(3-1.33)(2-0.67) + (-1-1.33)(1-0.67) + (2-1.33)(-1-0.67)] / (3-1)
>     = [1.67×1.33 + (-2.33)×0.33 + 0.67×(-1.67)] / 2
>     = [2.22 - 0.77 - 1.12] / 2
>     = 0.165

手算例子的原则：
- 数字小到能心算或纸上算（不超过 3×3 矩阵、不超过 5 个数据点）
- 保留中间步骤，不要跳步
- 最终结果给出明确数值

### 6. Mermaid 图（关系/流程/对比时使用）

数学讲义中 Mermaid 图的使用场景和金融讲义略有不同：

| 场景 | 图类型 | 例子 |
|------|--------|------|
| 概念依赖关系 | `graph TD`（树形） | 协方差 → 协方差矩阵 → PCA |
| 计算流程 | `graph LR`（流程） | 价格 → 收益率 → 均值/方差 → 回归 |
| 概念对比 | `graph LR` + subgraph | 总体参数 vs 样本统计量 |
| 数学分支和因子投资的映射 | `graph LR` | 回归 → CAPM/FF3 |

Mermaid 书写注意（同金融讲义）：
- 节点文本用双引号包裹，换行用 `<br>`
- 不要使用 emoji
- subgraph 名称不要用中文引号
- 保持简洁，单图节点不超过 10 个

### 7. 金融数据实例（重要概念尽量有）

用真实金融场景把抽象数学概念落地。

> **真实场景：沪深 300 的日收益率分布**
> 取 2020-2024 年沪深 300 日收益率数据，均值约 0.02%/天，标准差约 1.2%/天。
> 画出直方图会发现：中间比正态分布更"尖"，两端比正态分布更"胖"——这就是金融数据的"尖峰肥尾"特征。

### 8. 表格对比（有对比关系时必须）

| 维度 | 概念 A | 概念 B |
|------|--------|--------|
| 维度1 | ... | ... |
| 维度2 | ... | ... |

### 9. 和因子投资的映射（重要概念必须）

明确告诉读者"这个数学概念在因子投资的哪个环节会用到"。

> **在因子投资中的应用：** OLS 回归是因子模型的估计方法。当你看到 Fama-French 三因子模型
> R_i - R_f = alpha + b1*MKT + b2*SMB + b3*HML + e
> 这就是一个多元 OLS 回归。alpha 的 t 值是否显著，就是用假设检验（Day 5）来判断的。

---

## 四、自测题的写法

### 格式

数学自测题分两类：

**概念题：**
```
自测 N：问题？
→ 你的答案：_______________
→ 正确：简短的标准答案。
```

**计算题：**
```
自测 N：给出条件，求 xxx。
→ 你的计算：_______________
→ 正确：计算过程和答案。
```

### 原则

- 概念题和计算题各占一半
- 概念题测试直觉理解（"用自己的话解释 xxx"、"xxx 在因子投资中有什么用"）
- 计算题必须能手算（不需要计算器），测试是否真正掌握公式
- 题目数量 = 学习时间（小时）× 5，即 2 小时对应约 10 道题
- 末尾给评分标准：90% 以上 = 完美，70-80% = 回看错的部分，60% 以下 = 需要复习

---

## 五、写作原则

### 必须做的

1. **完全自包含**：读完讲义不需要看任何视频。所有知识点直接写在文档里
2. **每个概念都连接到因子投资**：读者要始终知道"我为什么在学这个数学"
3. **先直觉后形式化**：先给几何/视觉直觉，再给公式
4. **公式必须配翻译**：每个公式后面都有一句"翻译成人话"的解释
5. **每个公式都有手算例子**：小数字、能在纸上验证
6. **预判"数学生疏者"的困惑**：
   - "这个符号是什么意思？"——每个符号首次出现时解释
   - "为什么要这样定义？"——给出动机，不要说"定义就是这样"
   - "这个和那个有什么区别？"——相似概念必须对比
   - "我需要记住这个公式吗？"——明确标记"需要记住"还是"理解即可"
7. **标记深度边界**：明确告诉读者"这个证明不需要掌握"、"这个推导了解思路即可"

### 不能做的

1. **不写"请观看 3B1B 第 N 集"** — 需要的直觉直接写在讲义里
2. **不写"证明略"** — 要么给出简化版直觉解释，要么明确说"不需要掌握证明"
3. **不做完整数学证明** — 讲义不是教科书，只需要直觉理解和会用
4. **不堆符号** — 每个符号第一次出现时必须解释，同一个量不要换符号
5. **不讲因子投资不需要的数学** — 比如跳过 Jordan 标准形、测度论
6. **不用 emoji**
7. **不假设读者记得大学课本的内容** — 即使是"复习"，也要从直觉重新建立，不要说"你应该还记得..."

---

## 六、数学讲义 vs 金融讲义的关键差异

| 维度 | 金融讲义 | 数学讲义 |
|------|---------|---------|
| 类比来源 | 日常生活（菜市场、选美比赛） | 几何图形（箭头、旋转、椭圆） |
| 核心载体 | 文字描述 + Mermaid 图 + 表格 | 公式 + 手算例子 + Mermaid 图 |
| 例子类型 | 真实公司/市场数据 | 小规模手算 + 金融数据落地 |
| 自测题类型 | 概念理解为主 | 概念 + 计算各半 |
| "为什么学这个" | 连接到具体金融操作 | 连接到因子投资的数学步骤 |
| 深度控制 | "今天了解到这个程度" | "公式记住 / 推导不需要掌握" |

---

## 七、预判"数学生疏者"问题清单

理工科背景但数学生疏的人，常见困惑模式：

| 问题类型 | 典型问题 | 应对方式 |
|---------|---------|---------|
| 符号恐惧 | "这个 sigma 带下标又带上标是什么意思？" | 每个符号首次出现时用文字解释，并保持全文符号一致 |
| 直觉断裂 | "矩阵乘法为什么这样定义？感觉很不自然" | 给出动机（线性变换的复合），不要只给规则 |
| 维度混淆 | "协方差矩阵是几乘几的？每个格子代表什么？" | 用具体的 2×2 或 3×3 例子，标注行列含义 |
| 学了忘 | "方差的公式我以前学过，但现在想不起来了" | 不假设任何前置记忆，每个公式当第一次出现来写 |
| 用途不明 | "特征值分解很厉害，但我什么时候会用到？" | 立刻给因子投资场景（PCA 提取因子） |
| 过度焦虑 | "我需要把推导过程记住吗？" | 明确标注"需要记住"vs"理解即可"vs"知道存在就行" |

**规律：** 数学生疏者的问题核心是：
1. **符号和公式的"翻译"需求**（这个公式在说什么人话？）
2. **"我需要掌握到什么程度"的焦虑**（记住？理解？还是知道就行？）
3. **"为什么这样定义"的动机缺失**（课本直接给定义，但忘了为什么）

写讲义时应主动在公式旁边回答这三类问题。

---

## 八、Day 1 的实际结构（供参考）

```
第一节（50分钟）：向量
├── 一、向量是什么
│   ├── 1.1 三个视角（几何/数据/代数）  ← 表格对比
│   ├── 1.2 为什么要学（因子投资中的向量）  ← 表格映射
│   ├── 1.3 基本运算（加法、标量乘法）  ← 代码块示例 + 金融含义
│   ├── 1.4 点积 ⭐  ← 手算例子（3只股票组合收益率）
│   │   └→ 需要记住：点积 = 对应位置相乘再求和
│   ├── 1.5 转置  ← 代码块示例
│   │   └→ 需要记住：转置 = 行列互换
│   └── 1.6 维度  ← 表格（2维到5000维）
└── 完成检查（5 项 checklist）

第二节（50分钟）：矩阵 + 行列式 + 逆矩阵 + 因子模型
├── 二、矩阵是什么
│   ├── 2.1 从一只股票到多只股票  ← 收益率表格引入
│   ├── 2.2 维度（m×n）  ← 表格（金融场景维度）
│   ├── 2.3 矩阵乘法 ⭐  ← 维度规则 + 手算 2×2 + 金融含义（两个组合）
│   │   └→ 需要记住：内侧相等，外侧决定结果
│   ├── 2.4 矩阵转置  ← 代码块示例 + X'X 维度检查
│   └── 2.5 特殊矩阵（单位/对角/对称）  ← 表格
├── 三、行列式
│   ├── 3.1 直觉（空间的缩放倍数，det=0 → 压扁）
│   ├── 3.2 计算（2×2 公式 + 两个手算例子）
│   └── 3.3 因子投资联系（det=0 → 完全多重共线性）
│       └→ 需要记住：det=0 → 不可逆 → 回归失败
├── 四、逆矩阵
│   ├── 4.1 直觉（撤销操作）
│   ├── 4.2 不可逆条件（det=0）
│   ├── 4.3 计算（2×2 公式 + 手算 + 验证 A×A^{-1}=I）
│   └── 4.4 因子投资联系（OLS 公式 b=(X'X)^{-1}X'r）
│       └→ 需要记住：X'X 不可逆时回归失效
├── 五、秩
│   ├── 5.1 直觉（独立的维度数）
│   └── 5.2 因子投资联系（秩不足 = 因子冗余）
│       └→ 理解即可
├── 六、因子模型的矩阵形式 ⭐⭐
│   ├── 6.1 标量形式（单只股票）  ← 公式 + 逐符号解释
│   ├── 6.2 矩阵形式  ← 矩阵展开 + 维度检查
│   ├── 6.3 OLS 求解  ← 公式 + 维度检查 + 翻译成人话
│   └── 6.4 全景图  ← Mermaid 流程图
└── 完成检查（7 项 checklist）

收尾（10分钟）
├── 自测 10 道题（5 概念 + 5 计算）
├── 评分标准
├── 今天不需要记住的内容  ← 表格
└── 明天预告
```

### Day 1 编写中的关键设计决策

| 决策 | 选择 | 理由 |
|------|------|------|
| 向量的直觉用哪个？ | "一列数字"（数据视角），不强调"箭头" | 因子投资中不需要几何直觉，数据视角最实用 |
| 矩阵乘法讲几何变换吗？ | 不讲，只讲"每行做点积" | 几何变换对因子投资无直接用处，增加认知负担 |
| 行列式讲多大？ | 只讲 2×2 | 实际中用 numpy，更大的手算无意义 |
| 逆矩阵讲多深？ | 2×2 公式 + 因子投资联系 | 不需要高斯消元法，知道"什么时候不可逆"比"怎么算"重要 |
| 秩讲多深？ | 只讲直觉，不讲计算 | "秩不足 = 因子冗余"是唯一需要知道的 |
| 是否在 Day 1 就引入因子模型？ | 是，作为压轴内容 | 给全天的概念一个"汇聚点"，让每个零散概念有归属感 |

### Day 1 的深度标记策略

讲义中使用了三级深度标记：

| 标记 | 含义 | Day 1 中的例子 |
|------|------|---------------|
| **需要记住** | 后续天数会直接用到，必须形成肌肉记忆 | 点积公式、维度规则、det=0 → 不可逆 |
| **理解即可** | 知道这件事存在、知道为什么，但不需要默写 | 矩阵的秩、代数性质 |
| **知道存在就行** | 提一嘴就够了，以后遇到再查 | 线性变换的几何意义 |
