# Day 2：交易机制（A股+加密） + 矩阵运算

> 总时长：4 小时
>
> 节奏：每 50 分钟休息 10 分钟（番茄钟）
>
> 今日目标：搞懂"你点了买入之后到底发生了什么"（A股和加密交易所），掌握矩阵乘法/行列式/逆矩阵的直觉和代码

---

## 时间表总览

```
00:00 - 00:50  [金融 第1节] 订单簿与撮合：你下单后发生了什么？
00:50 - 01:00  休息
01:00 - 01:50  [金融 第2节] A股 vs 加密交易所规则 + 实际看一次行情
01:50 - 02:00  休息
02:00 - 02:50  [数学 第1节] 矩阵乘法、行列式、逆矩阵（看视频）
02:50 - 03:00  休息
03:00 - 03:50  [数学 第2节] Jupyter 里验证矩阵运算（环境已在 Day 1 搭好）
03:50 - 04:00  休息
04:00 - 04:30  [收尾] 整理笔记 + 自测
```

---

## 第一节：你下单后发生了什么？（50 分钟）

### 步骤 1：理解"交易"的本质（15 分钟）

先不看书，在脑子里想象一个场景：

> 你打开手机券商 APP，输入"贵州茅台"，看到价格 1800 元，
> 点了"买入 100 股"。然后呢？钱去了哪里？股票从哪里来？

带着这个画面，阅读以下概念并在笔记本上写下答案：

```
概念 1：交易所
─────────────
交易所 = 股票交易的"菜市场"。
中国有两个主要交易所：
  - 上海证券交易所（上交所，代码以 6 开头，如 600519 茅台）
  - 深圳证券交易所（深交所，代码以 0/3 开头，如 000001 平安银行）

你的券商 APP 只是一个"代理"，帮你把订单送到交易所。

✍️ 写下：上交所股票代码以___开头，深交所以___开头
```

```
概念 2：订单簿（Order Book）
───────────────────────────
订单簿 = 交易所维护的一张"排队表"，记录所有人的买单和卖单。

想象一个简化的订单簿：

  卖方（挂单卖出）           买方（挂单买入）

  | 档位 | 价格     | 数量  |    | 档位 | 价格    | 数量  |
  |------|----------|------|----|------|---------|------|
  | 卖5  | 1803 元  | 200股 |    |      |         |      |
  | 卖4  | 1802 元  | 150股 |    |      |         |      |
  | 卖3  | 1801 元  | 300股 |    |      |         |      |
  | 卖2  | 1800.5元 | 100股 |    |      |         |      |
  | 卖1  | 1800 元  | 50股  | <= | 买1  | 1799 元 | 80股  |
  |      |          |      |    | 买2  | 1798 元 | 120股 |
  |      |          |      |    | 买3  | 1797 元 | 200股 |
  |      |          |      |    | 买4  | 1796 元 | 150股 |
  |      |          |      |    | 买5  | 1795 元 | 300股 |

卖1（1800元）= 最低卖价 = 有人愿意最少以 1800 元卖给你
买1（1799元）= 最高买价 = 有人愿意最多出 1799 元买

买1 和 卖1 之间的差 = 1800 - 1799 = 1 元 = "买卖价差"（Spread）

✍️ 写下：
- 最低卖价叫___（卖一 / Ask）
- 最高买价叫___（买一 / Bid）
- 两者的差叫___（Spread / 买卖价差）
```

```
概念 3：限价单 vs 市价单
────────────────────────
限价单："我要以 1799 元买 100 股"
  → 如果当前没有人愿意以 1799 元卖，你的单子就挂在那里排队
  → 好处：价格可控；坏处：可能买不到

市价单："我现在就要买 100 股，什么价格都行"
  → 交易所立刻用订单簿中最优的卖单给你成交
  → 好处：一定能买到；坏处：价格不可控，可能比你预期的贵

✍️ 写下：如果你着急买到用___单，如果你想控制价格用___单
```

### 步骤 2：理解撮合机制（15 分钟）

```
概念 4：撮合成交
───────────────
交易所的核心工作 = 撮合（Matching）。

规则很简单：
  如果 最高买价 ≥ 最低卖价 → 成交！

例子：
  买方出价 1800 元买 100 股
  卖方挂 1800 元卖 50 股
  → 成交 50 股，价格 1800 元
  → 买方还剩 50 股没买到，继续排队

成交价格的确定：
  - 连续竞价（9:30-11:30, 13:00-15:00）：价格优先、时间优先
    先匹配价格最优的，价格相同先到先得
  - 集合竞价（9:15-9:25）：把这段时间所有订单收集起来，
    找一个价格让成交量最大，这个价格就是开盘价

✍️ 画一个简图说明撮合过程：
   买方出 1800 ──→ 交易所撮合 ←── 卖方挂 1800
                      ↓
                成交！1800元
```

```
概念 5：为什么这些对因子投资重要？
─────────────────────────────────
做因子投资回测时，我们会假设"以收盘价买入"。
但实际交易中：
  (1) 你可能买不到收盘价（你的单子会影响价格）
  (2) 买卖价差是一种隐性成本
  (3) 大单会"吃掉"多个档位的挂单，导致成交均价偏离预期

这就是"滑点"和"冲击成本"的来源。
在第 6 周学回测时，我们会把这些成本加进去。

注意：这些概念在加密交易所上完全一样！
而且加密市场的一些币种流动性更差，滑点可能更大。

✍️ 写下：回测假设以收盘价成交，但实际交易中存在___和___
  → 答案：滑点（Slippage）和冲击成本（Market Impact）
```

### 步骤 3：阅读《漫步华尔街》第 2 章——大众疯狂（20 分钟）

打开《漫步华尔街》第 2 章，快速阅读。

> 这一章讲历史上的投机泡沫：郁金香球茎热、南海泡沫、华尔街崩溃。
> 阅读目的不是记住每个泡沫的细节，而是感受一个核心信息：

```
✍️ 读完后写下：
问题：泡沫为什么会反复发生？
→ 你的理解：________________
→ 参考：因为人性不变——贪婪和恐惧会让价格严重偏离价值。
  这恰恰是因子投资存在的基础：如果市场完全理性，
  就不会有"便宜股票收益更高"（价值因子）这种现象。
  加密市场更是如此——2017 ICO泡沫、2021 NFT/Meme币狂潮
  都是泡沫的经典案例。加密市场的非理性程度更高，
  这意味着因子投资的潜在机会可能更大（但风险也更大）。
```

**休息 10 分钟。**

---

## 第二节：A股 vs 加密交易所规则 + 看一次实际行情（50 分钟）

### 步骤 4：交易规则对比速查表（25 分钟）

逐条阅读并在笔记上抄写一遍（抄写的过程能帮你记住）：

**A 股 vs 加密货币交易规则对比**

| 项目 | A 股 | 加密货币（CEX） |
|------|------|----------------|
| **交易时间** | 周一到周五，上午 9:30-11:30，下午 13:00-15:00（共 4 小时） | **24/7 全年无休**（包括节假日） |
| **交割制度** | T+1：今天买的股票，明天才能卖 | **T+0**：买了马上可以卖 |
| **涨跌停限制** | 主板 ±10%、创业板/科创板 ±20%、北交所 ±30%、ST ±5% | **无涨跌停**（一天涨跌 50%+ 都可能） |
| **最小交易单位** | 1 手 = 100 股 | 通常可以买很小的量（如 0.001 BTC） |
| **交易费用** | 佣金万2-万3（双向）+ 印花税千1（卖出） | Maker 0.02-0.1%、Taker 0.04-0.1%（双向，无印花税） |
| **做空机制** | 融券（门槛高、成本高） | 合约交易可直接做空（杠杆 1-125x） |
| **代码规则** | 60xxxx=上交所、00xxxx=深交所、30xxxx=创业板 | 交易对：BTC/USDT、ETH/USDT 等 |
| **对因子投资影响** | T+1 今天选出明天才能买；涨跌停影响回测；100 股起买导致小资金难分散 | T+0 可即时调仓；无涨跌停需更严格的风控；小资金也能充分分散 |

> **Maker vs Taker**：限价单挂在订单簿上等成交 = Maker（提供流动性，费率低）；
> 市价单立刻吃掉已有挂单 = Taker（消耗流动性，费率高）。
> 这和 A 股不同——A 股不区分 maker/taker，统一收佣金。

**A 股细节补充**（仍然需要了解）：
- 9:15-9:25 集合竞价确定开盘价
- 股票代码：68xxxx = 科创板、8xxxxx = 北交所
- 佣金最低 5 元，过户费十万分之 1.5（上交所）

```
✍️ 小练习 1：计算 A 股交易成本
假设你以 50 元买入某股票 1000 股，然后以 55 元全部卖出。
佣金费率万 2.5，印花税千 1。

买入成本：
  买入金额 = 50 × 1000 = 50,000 元
  买入佣金 = 50,000 × 0.00025 = 12.5 元

卖出成本：
  卖出金额 = 55 × 1000 = 55,000 元
  卖出佣金 = 55,000 × 0.00025 = 13.75 元
  印花税   = 55,000 × 0.001 = 55 元

总费用 = 12.5 + 13.75 + 55 = 81.25 元
利润   = 55,000 - 50,000 - 81.25 = 4,918.75 元
费用占利润的比例 = 81.25 / 5000 = 1.6%

✍️ 写下：这笔交易毛利 5000 元，交易费用吃掉了___元，占比___%
```

```
✍️ 小练习 2：计算加密货币交易成本
假设你以 60,000 USDT 买入 1 BTC，然后以 66,000 USDT 卖出。
Maker 费率 0.1%，两次都用限价单（Maker）。

买入成本：
  买入金额 = 60,000 USDT
  买入手续费 = 60,000 × 0.001 = 60 USDT

卖出成本：
  卖出金额 = 66,000 USDT
  卖出手续费 = 66,000 × 0.001 = 66 USDT

总费用 = 60 + 66 = 126 USDT（无印花税！）
利润   = 66,000 - 60,000 - 126 = 5,874 USDT
费用占利润的比例 = 126 / 6000 = 2.1%

✍️ 对比：A 股费用比 1.6%，加密费用比 2.1%
  加密交易费率虽然看起来低（没有印花税），但 maker/taker 费率通常
  比 A 股佣金高。不过加密交易所有 VIP 阶梯费率，交易量大可以降低。
```

### 步骤 5：看一次真实行情——A 股和加密各看一个（25 分钟）

#### 任务 A：看 A 股行情（12 分钟）

打开浏览器，进入**东方财富网** (https://www.eastmoney.com)。

> 也可以用你手机上的任何炒股 APP（同花顺、东方财富、雪球等）

**找到贵州茅台（600519）的实时行情页面**，在搜索框输入 "600519"。

```
✍️ 记录你看到的数据：
  当前价格：_____ 元
  今日涨跌：_____ %
  成交量：_____ 手
  成交额：_____ 亿元
  市盈率（PE）：_____
  市净率（PB）：_____
```

找到"盘口"或"五档行情"区域：

```
✍️ 回答：
- 卖1 价格是多少？_____ 元
- 买1 价格是多少？_____ 元
- 买卖价差（Spread）= 卖1 - 买1 = _____ 元
- 价差占股价的百分比 = Spread / 股价 × 100 = _____%
  （茅台这种大股票价差通常很小，不到 0.01%）
```

#### 任务 B：看加密货币行情（13 分钟）

打开浏览器，进入 **Binance**（https://www.binance.com）或 **CoinGecko**（https://www.coingecko.com）。

> 如果 Binance 不方便访问，OKX（https://www.okx.com）也可以

**找到 BTC/USDT 的交易页面**。

```
✍️ 记录你看到的数据：
  BTC 当前价格：_____ USDT
  24h 涨跌：_____ %
  24h 成交量：_____ BTC
  24h 成交额：_____ USDT
```

在 Binance 交易页面观察订单簿（和 A 股的盘口一样！）：

```
✍️ 回答：
- 卖1 价格（Best Ask）：_____ USDT
- 买1 价格（Best Bid）：_____ USDT
- Spread = _____ USDT
- 价差占价格的百分比 = _____%
  （BTC 的 Spread 通常极小，约 0.001%）
```

**对比两个市场的订单簿，你会发现机制完全一样！**
不同的只是品种、交易时间和规则。

#### 任务 C：看 K 线图（两个市场各看一眼）

K 线快速入门（不用深入，知道怎么看就行）：

> 一根 K 线 = 一天的价格信息。
> 中国股市：**红涨绿跌**（和欧美相反！）
> 加密市场：通常**绿涨红跌**（和欧美一样）

| 位置 | 含义 |
|------|------|
| 上影线顶端 | 最高价 |
| 实体上沿 | 收盘价（涨）或 开盘价（跌） |
| 实体下沿 | 开盘价（涨）或 收盘价（跌） |
| 下影线底端 | 最低价 |

```
✍️ 看两个 K 线图，对比：
  茅台最近一个月波动幅度大约：_____ %
  BTC 最近一个月波动幅度大约：_____ %
  → 加密货币的波动通常是 A 股的 3-5 倍
```

**休息 10 分钟。**

---

## 第三节：矩阵乘法、行列式、逆矩阵（50 分钟）

### 步骤 6：看视频（45 分钟）

打开 B 站，继续看 **3Blue1Brown《线性代数的本质》**。

今天看 3 集：

```
第 4 集：矩阵乘法与线性变换复合（约 10 分钟）
────────────────────────────────────────────
核心概念：两个矩阵相乘 = 依次做两个线性变换

看完后在笔记上写：
- A × B 的含义 = 先做 B 变换，再做 A 变换（注意顺序！）
- 矩阵乘法不满足交换律：A×B ≠ B×A（一般情况下）
- 和投资的联系：暂时没有直接联系，但这是理解后面内容的基础


第 5 集：行列式（约 10 分钟）
──────────────────────────
核心概念：行列式 = 线性变换对面积（体积）的缩放倍数

看完后在笔记上写：
- det(A) > 0：变换后面积放大/缩小，但方向没翻转
- det(A) < 0：变换后方向翻转了（像照镜子）
- det(A) = 0：变换后降维了（面积变成 0，二维压成一条线）
  → 这意味着矩阵是"奇异的"（singular），不可逆
- 记住公式：对于 2×2 矩阵 [[a,b],[c,d]]，det = ad - bc

✍️ 手算：det([[3,1],[2,4]]) = 3×4 - 1×2 = ___
  → 答案：10


第 6 集：逆矩阵、列空间与零空间（约 12 分钟）
──────────────────────────────────────────
核心概念：逆矩阵 = "撤销"一个线性变换

看完后在笔记上写：
- A 的逆矩阵记作 A⁻¹
- A × A⁻¹ = A⁻¹ × A = I（单位矩阵）
- 只有 det(A) ≠ 0 时，A⁻¹ 才存在
- 和投资的联系：
  → 投资组合优化中有公式 β = (X'X)⁻¹X'y
    这里面就要对矩阵求逆
    如果矩阵不可逆（奇异），优化就解不出来
```

### 步骤 7：手写练习（5 分钟）

在笔记本上手算，不用计算器：

```
练习 1：2×2 矩阵乘法
[1 2]   [5 6]   [1×5+2×7  1×6+2×8]   [?  ?]
[3 4] × [7 8] = [3×5+4×7  3×6+4×8] = [?  ?]

答案：[[19, 22], [43, 50]]
  19 = 1×5 + 2×7
  22 = 1×6 + 2×8
  43 = 3×5 + 4×7
  50 = 3×6 + 4×8


练习 2：行列式
det([[2, 3],
     [1, 4]]) = 2×4 - 3×1 = ?

答案：5


练习 3：验证逆矩阵（给你答案，你来验证）
A = [[2, 1],
     [1, 1]]

A⁻¹ = [[ 1, -1],
       [-1,  2]]

验证：A × A⁻¹ 应该 = [[1,0],[0,1]]

第一行第一列：2×1 + 1×(-1) = 2 - 1 = 1  ✓
第一行第二列：2×(-1) + 1×2 = -2 + 2 = 0  ✓
第二行第一列：1×1 + 1×(-1) = 1 - 1 = 0   ✓
第二行第二列：1×(-1) + 1×2 = -1 + 2 = 1  ✓

结果 = [[1,0],[0,1]] = 单位矩阵 ✓
```

**休息 10 分钟。**

---

## 第四节：Jupyter 验证矩阵运算（50 分钟）

### 步骤 8：打开 Jupyter（2 分钟）

环境在 Day 1 已经搭建好了。打开终端：

```bash
cd ~/Work/Trade/factor-investing-study/code
uv run jupyter notebook --notebook-dir=notebooks
```

> 如果 Day 1 的 Jupyter 还开着，直接切到浏览器即可。

### 步骤 9：新建 Notebook 并验证矩阵运算（48 分钟）

在 Jupyter 页面中：
1. 点击右上角 **"New"** → **"Python 3"**
2. 点击最上方的 "Untitled" 重命名为 **"Week01_Day2_矩阵运算"**

然后逐个 Cell 输入以下代码，**每个 Cell 输入完按 `Shift + Enter` 运行**：

---

**Cell 1：导入 numpy**

```python
import numpy as np
print("numpy 版本:", np.__version__)
```

你应该看到：`numpy 版本: 2.x.x`（具体版本号不重要）

---

**Cell 2：矩阵乘法**

```python
# ===== 矩阵乘法 =====
# 和手算练习 1 对应

A = np.array([[1, 2],
              [3, 4]])

B = np.array([[5, 6],
              [7, 8]])

# 方法 1：用 @ 运算符（推荐，最直观）
C = A @ B

print("A @ B =")
print(C)

# 验证和手算结果一致
assert C[0, 0] == 19, "第(0,0)位置不对"
assert C[0, 1] == 22, "第(0,1)位置不对"
assert C[1, 0] == 43, "第(1,0)位置不对"
assert C[1, 1] == 50, "第(1,1)位置不对"
print("\n✓ 和手算结果一致")
```

你应该看到：
```
A @ B =
[[19 22]
 [43 50]]

✓ 和手算结果一致
```

---

**Cell 3：矩阵乘法不满足交换律**

```python
# ===== 验证 A×B ≠ B×A =====
print("A @ B =")
print(A @ B)
print()
print("B @ A =")
print(B @ A)
print()
print("A@B 和 B@A 相等吗?", np.array_equal(A @ B, B @ A))
```

你应该看到：
```
A @ B =
[[19 22]
 [43 50]]

B @ A =
[[23 34]
 [31 46]]

A@B 和 B@A 相等吗? False
```

> 重要结论：**矩阵乘法顺序不能随便换！** 这和数字乘法不一样（3×5 = 5×3 但矩阵不行）。

---

**Cell 4：行列式**

```python
# ===== 行列式 =====
# 对应手算练习 2

M = np.array([[2, 3],
              [1, 4]])

det = np.linalg.det(M)
print(f"det(M) = {det:.1f}")

# 手算验证：2×4 - 3×1 = 5
assert abs(det - 5.0) < 1e-10, "行列式计算不对"
print("✓ 和手算结果一致")
```

你应该看到：
```
det(M) = 5.0
✓ 和手算结果一致
```

---

**Cell 5：行列式 = 0 意味着什么**

```python
# ===== 行列式为 0 的矩阵（奇异矩阵）=====
# 这个矩阵的第二行是第一行的 2 倍，信息冗余

singular_matrix = np.array([[1, 2],
                            [2, 4]])

det = np.linalg.det(singular_matrix)
print(f"det = {det:.1f}")
print("行列式为 0，说明这个矩阵是'奇异的'")
print("直觉：两行线性相关（第二行=第一行×2），没有新信息")
print()

# 尝试求逆会怎样？
try:
    inv = np.linalg.inv(singular_matrix)
    print("求逆成功（不应该走到这里）")
except np.linalg.LinAlgError as e:
    print(f"求逆失败！错误: {e}")
    print("→ 奇异矩阵不可逆，这很重要！")
```

你应该看到：
```
det = 0.0
行列式为 0，说明这个矩阵是'奇异的'
直觉：两行线性相关（第二行=第一行×2），没有新信息

求逆失败！错误: Singular matrix
→ 奇异矩阵不可逆，这很重要！
```

> **注意**：numpy 的浮点运算有精度问题，det 可能显示为 `0.0` 或一个极小的数如 `2.2e-16`。
> 如果你看到的不是精确的 0 也没关系，只要非常接近 0 就说明矩阵接近奇异。

---

**Cell 6：逆矩阵**

```python
# ===== 逆矩阵 =====
# 对应手算练习 3

A = np.array([[2, 1],
              [1, 1]])

# 用 numpy 求逆
A_inv = np.linalg.inv(A)

print("A =")
print(A)
print()
print("A 的逆矩阵 =")
print(A_inv)
print()

# 验证 A × A⁻¹ = 单位矩阵
product = A @ A_inv
print("A × A⁻¹ =")
print(np.round(product, 10))  # round 消除浮点误差

# 检查是否接近单位矩阵
identity = np.eye(2)  # 2×2 单位矩阵 [[1,0],[0,1]]
assert np.allclose(product, identity), "不是单位矩阵！"
print("\n✓ A × A⁻¹ = 单位矩阵，验证通过")
```

你应该看到：
```
A =
[[2 1]
 [1 1]]

A 的逆矩阵 =
[[ 1. -1.]
 [-1.  2.]]

A × A⁻¹ =
[[1. 0.]
 [0. 1.]]

✓ A × A⁻¹ = 单位矩阵，验证通过
```

---

**Cell 7：矩阵在投资中的实际用途预告**

```python
# ===== 矩阵在投资中的用途（预告，看懂多少算多少）=====

# 场景：你有 3 只股票 5 天的收益率数据
# 你想知道：这 3 只股票之间的"联动关系"如何？

returns = np.array([
    [ 0.02, -0.01,  0.015],   # 第1天：股票A涨2%, B跌1%, C涨1.5%
    [ 0.01,  0.02, -0.005],   # 第2天
    [-0.03,  0.01,  0.02 ],   # 第3天
    [ 0.015, 0.005, 0.01 ],   # 第4天
    [ 0.01, -0.015, 0.025],   # 第5天
])

print("收益率矩阵 (5天 × 3只股票):")
print(returns)
print(f"形状: {returns.shape}")
print()

# 协方差矩阵：衡量股票之间的联动关系
# rowvar=False 表示每一列是一个变量（股票），每一行是一个观测值（天）
cov_matrix = np.cov(returns, rowvar=False)

print("协方差矩阵 (3×3):")
print(np.round(cov_matrix, 6))
print()
print("怎么读这个矩阵：")
print(f"  对角线 = 各股票收益率的方差（波动大小）")
print(f"  股票A的方差: {cov_matrix[0,0]:.6f}")
print(f"  股票B的方差: {cov_matrix[1,1]:.6f}")
print(f"  股票C的方差: {cov_matrix[2,2]:.6f}")
print()
print(f"  非对角线 = 两只股票的协方差（联动关系）")
print(f"  A和B的协方差: {cov_matrix[0,1]:.6f}")
if cov_matrix[0, 1] < 0:
    print(f"  → 负数，说明 A 涨的时候 B 倾向于跌（负相关）")
else:
    print(f"  → 正数，说明 A 涨的时候 B 也倾向于涨（正相关）")
print()
print("这个协方差矩阵在第 3 周（投资组合优化）和第 12 周（组合优化）会反复用到")

# 验证协方差矩阵的两个重要性质
det_cov = np.linalg.det(cov_matrix)
eigenvalues = np.linalg.eigvals(cov_matrix)

print(f"\n协方差矩阵的行列式: {det_cov:.10f}")
print(f"协方差矩阵的特征值: {np.round(eigenvalues, 8)}")
print(f"所有特征值 ≥ 0? {all(v >= -1e-10 for v in eigenvalues)}")
print("→ 协方差矩阵一定是半正定的（特征值都≥0）")
```

> **这个 Cell 能跑通就行，不需要完全理解。** 目的是让你预览一下：
> "矩阵运算"不是数学课上的无聊作业，它在投资中有非常具体的用途。

---

**Cell 8：保存并记录**

```python
# ===== 今日学习总结 =====
print("""
Day 2 代码练习完成！

今天用 numpy 实现了：
  1. 矩阵乘法      → A @ B
  2. 行列式         → np.linalg.det(A)
  3. 逆矩阵         → np.linalg.inv(A)
  4. 协方差矩阵     → np.cov(returns, rowvar=False)

记住的 numpy 函数：
  np.array()         创建矩阵/向量
  A @ B              矩阵乘法
  np.linalg.det(A)   行列式
  np.linalg.inv(A)   逆矩阵
  np.linalg.eigvals(A)  特征值
  np.cov()           协方差矩阵
  np.eye(n)          n×n 单位矩阵
  np.round(A, n)     四舍五入到 n 位小数
  np.allclose(A, B)  检查两个矩阵是否近似相等
""")
```

写完最后一个 Cell 后，按 `Ctrl + S` 保存 Notebook。

**休息 10 分钟。**

---

## 收尾：整理笔记 + 自测（30 分钟）

### 步骤 10：整理今日笔记

在笔记本（或新建一个 Markdown 文件）上写下：

```
# Day 2 学习笔记 - [今天的日期]

## 金融部分
1. 交易所 = 股票交易的场所（上交所 + 深交所）；加密市场有 CEX（Binance等）和 DEX
2. 订单簿 = 记录所有买卖挂单的排队表（A股和加密交易所机制相同）
3. 限价单 = 指定价格（Maker），市价单 = 立刻成交（Taker）
4. 撮合 = 买价 ≥ 卖价 时成交
5. A 股规则：T+1、涨跌停 ±10%/±20%、最少买 100 股
6. 加密规则：T+0、无涨跌停、24/7全年无休、可小额交易
7. 交易费用对比：A股（佣金+印花税）vs 加密（maker/taker手续费）
8. 泡沫会反复发生，因为人性不变 → 这是因子投资存在的基础（加密市场尤其如此）

## 数学部分
1. 矩阵乘法 = 线性变换的复合，顺序不能换（A×B ≠ B×A）
2. 行列式 = 变换的面积缩放倍数，det=0 说明矩阵奇异
3. 逆矩阵 = 变换的"撤销"，A×A⁻¹ = I
4. 只有 det(A) ≠ 0 时逆矩阵才存在

## 今天新学的代码
- A @ B             矩阵乘法
- np.linalg.det(A)  行列式
- np.linalg.inv(A)  逆矩阵
- np.cov(X, rowvar=False) 协方差矩阵

## 项目环境
- 用 uv 初始化了 code 目录，安装了 numpy/pandas/matplotlib/jupyter
- Jupyter Notebook 存放在 code/notebooks/ 目录下
```

### 步骤 11：自测

拿一张白纸，不看任何资料，回答以下问题：

```
自测 1：你在券商 APP 上买入 100 股茅台，这个订单会被送到哪里？
→ 你的答案：_______________
→ 正确：交易所（上交所或深交所），由交易所撮合成交

自测 2：限价单和市价单的区别？加密交易所里叫什么？
→ 你的答案：_______________
→ 正确：限价单指定价格（Maker），市价单立刻成交（Taker）

自测 3：A 股 T+1 和加密 T+0 对因子投资分别有什么影响？
→ 你的答案：_______________
→ 正确：A股 T+1 意味着今天选出的股票明天才能买；
  加密 T+0 可以即时调仓，策略执行更灵活。

自测 4：A 股和加密市场在涨跌停上有什么区别？
→ 你的答案：_______________
→ 正确：A股有涨跌停保护（±10%/±20%），加密无涨跌停（波动可能极大）

自测 5：det([[3, 1], [2, 4]]) = ？
→ 你的答案：_______________
→ 正确：3×4 - 1×2 = 10

自测 6：行列式 = 0 说明什么？
→ 你的答案：_______________
→ 正确：矩阵奇异（不可逆），直觉上是信息冗余/降维了

自测 7：用 numpy 怎么做矩阵乘法？（写出代码）
→ 你的答案：_______________
→ 正确：C = A @ B  或  C = np.dot(A, B)  或  C = np.matmul(A, B)

自测 8：买入 5 万元 A 股（佣金万 2.5），之后以 5.5 万元卖出
       （佣金万 2.5 + 印花税千 1），总交易费用是多少？
→ 你的答案：_______________
→ 正确：12.5 + 13.75 + 55 = 81.25 元

自测 9：在 Binance 以 60,000 USDT 买入 1 BTC（Maker 0.1%），
       以 66,000 USDT 卖出（Maker 0.1%），总手续费是多少？
→ 你的答案：_______________
→ 正确：60 + 66 = 126 USDT
```

**9 道全对**：完美！
**7-8 道对**：很好，看看错的部分再过一遍。
**6 道以下**：别急，明天开始前花 20 分钟复习今天的内容。

---

## 今天没听懂也不要慌的内容

| 概念 | 今天需要理解到什么程度 | 什么时候会深入 |
|------|---------------------|--------------|
| 集合竞价 | 知道开盘价不是随便定的就行 | 实盘交易时 |
| 合约/杠杆交易 | 知道加密市场可以做空就行 | 第 14-16 周（进阶） |
| 协方差矩阵 | 知道"能衡量股票联动"就行 | 第 3 周 Day 5 |
| 半正定 | 知道这个词就行 | 第 12 周（组合优化） |
| 特征值 | 知道 numpy 能算就行 | 第 1 周 Day 4 会深入 |

---

## 明天预告

**Day 3** 会学习：
- **金融**：债券是怎么运作的？什么是到期收益率？ETF 和共同基金到底该选哪个？
- **数学**：矩阵的秩、零空间、列空间——为什么有些方程组无解？

今晚睡前 5 分钟回忆：A 股和加密市场的核心规则区别？矩阵乘法的顺序为什么不能换？
